rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // REGRA GERAL:
    // Exige que um usuário esteja autenticado para realizar qualquer operação de leitura ou escrita.
    // Esta é a principal camada de segurança que impede o acesso anônimo.
    // A lógica de negócio e as permissões granulares (quem pode editar o quê)
    // são controladas pela aplicação (pelo código e pelos guards, como o SuperAdminGuard).
    match /{document=**} {
      allow read, write: if request.auth != null;
    }
  }
}
